var extend=function(e,t){function n(){this.constructor=e}for(var r in t)hasProp.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty;!function(e,t){var n,r,o,i,s,u,a,l,c,p,f;if(e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global,"function"==typeof define&&define.amd)return define(["underscore","jquery","backbone","backbone-associations","backbone.marionette","i18next-client","exports","underscore.string","numeral","moment","moment-range"],function(n,r,o,i,s,u,a,l,c,p,f){var m;m=t(e,a,o,s,n,r,u,l,c,p),e.Marionetist=m});if("undefined"!=typeof exports){s=require("underscore"),n=void 0,r=require("backbone"),i=require("backbone.marionette"),a=require("i18next-client"),f=require("underscore.string"),o=require("backbone-associations"),p=require("numeral"),l=require("moment"),c=require("moment-range");try{n=require("jquery")}catch(m){u=m}return module.exports=e.Marionetist=t(e,exports,r,i,s,n,a,f,p,l)}return e.Marionetist=t(e,{},e.Backbone,e.Marionette,e._,e.jQuery||e.Zepto||e.ender||e.$,e.i18n,e.s,e.numeral,e.moment)}(this,function(e,t,n,r,o,i,s,u,a,l){var c,p;return null==l.range&&console.error("Unable to load moment-range"),c=r.extend(),c.Backbone=n,c.Marionette=r,c._=o,c.$=i,c.s=u,c.I18n=s,c.numeral=a,c.moment=l,c.Config=new c.Object,p=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return extend(n,t),n.prototype.lookupPaths=["templates/"],n.prototype.engine=function(){var t;return t={},null!=e.HAML&&(t=HAML),null!=e.JST&&(t=JST),t},n}(c.Object),c.Config.options.templates=new p,o.extend(c.Renderer,{lookups:c.Config.getOption("templates").getOption("lookupPaths"),render:function(e,t){var n;if(o.isFunction(e))return e(t);if(e!==!1){if(n=this.getTemplate(e),!n)throw"Template "+e+" not found!";return n(t)}},getTemplate:function(e){var t,n,r,i,s,u,a,l,p;for(l=this.lookups,n=0,i=l.length;i>n;n++)for(u=l[n],p=[e,this.withTemplate(e)],r=0,s=p.length;s>r;r++)if(a=p[r],t=c.Config.getOption("templates").getOption("engine"),o.isFunction(t)&&(t=t()),t[u+a])return t[u+a]},withTemplate:function(e){var t;return null!=e?(t=e.split("/"),t.splice(-1,0,"templates"),t.join("/")):void 0}}),c.Views=new c.Object,c.Views.templateHelpers={t:c.I18n.t,formatCurrency:function(e,t){return null==t&&(t="$0,0.00"),c.numeral(e).format(t)},formatNumber:function(e,t){return null==t&&(t="0,0.00"),c.numeral(e).format(t)},formatPercentage:function(e,t){return null==t&&(t="0.00%"),c.numeral(e).format(t)},formatDate:function(e,t){return null==t&&(t="DD-MM-YYYY"),c.moment(e).format(t)}},o.extend(c.View.prototype,{templateHelpers:function(){return c.Views.templateHelpers}}),c.Views.Collection=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t}(r.CollectionView),c.Views.Composite=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t}(r.CompositeView),c.Views.Layout=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t}(r.LayoutView),c.Views.Item=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t}(r.ItemView),c.Entities=new c.Object,c.Entities.Models=new c.Object,c.Entities.Collections=new c.Object,c.Entities.Models.Base=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t}(n.Model),n.AssociatedModel?c.Entities.Models.Associated=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t}(n.AssociatedModel):"undefined"!=typeof console&&null!==console&&console.error("Unable to load backbone-associations"),c.Entities.Collections.Base=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t}(n.Collection),c.Controllers=new c.Object,c.Controllers.Base=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t}(c.Object),c.Application=c.Application.extend({Backbone:c.Backbone,Marionette:c.Marionette,_:c._,$:c.$,s:c.s,I18n:c.I18n,numeral:c.numeral,moment:c.moment,Controllers:new c.Object,Entities:new c.Object,Views:new c.Object,navigate:function(e,t){return null==t&&(t={}),c.Backbone.history.navigate(e,t)},getCurrentRoute:function(){var e;return e=c.Backbone.history.fragment,o.isEmpty(e)?null:e},startHistory:function(e){return null==e&&(e={}),null!=c.Backbone.history?c.Backbone.history.start(e):void 0},register:function(e,t){return null==this._registry&&(this._registry={}),this._registry[t]=e},unregister:function(e,t){return delete this._registry[t]},resetRegistry:function(){var e,t,n,r,o;r=this.getRegistrySize(),o=this._registry;for(t in o)e=o[t],e.region.close();return n="There were "+r+" controllers in the registry, there are now "+this.getRegistrySize(),this.getRegistrySize()>0?console.warn(n,this._registry):console.log(n)},getRegistrySize:function(){return o.size(this._registry)}}),c});