var extend=function(e,t){function n(){this.constructor=e}for(var r in t)hasProp.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty;!function(e,t){var n,r,i,o,s,u;if(e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global,"function"==typeof define&&define.amd)return define(["underscore","jquery","backbone","i18next-client","exports"],function(n,r,o,s,u){var l;l=t(e,u,o,i,n,r,s),e.Marionetist=l});if("undefined"!=typeof exports){o=require("underscore"),n=void 0,r=require("backbone"),i=require("backbone.marionette"),u=require("i18next-client");try{n=require("jquery")}catch(l){s=l}return module.exports=e.Marionetist=t(e,exports,r,i,o,n,u)}return e.Marionetist=t(e,{},e.Backbone,e.Marionette,e._,e.jQuery||e.Zepto||e.ender||e.$,e.i18n)}(this,function(e,t,n,r,i,o,s){var u,l;return u=r.extend(),u.I18n=s,u.Config=new u.Object,l=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return extend(n,t),n.prototype.lookupPaths=["templates/"],n.prototype.engine=function(){var t;return t={},null!=e.HAML&&(t=HAML),null!=e.JST&&(t=JST),t},n}(u.Object),u.Config.options.templates=new l,i.extend(u.Renderer,{lookups:u.Config.getOption("templates").getOption("lookupPaths"),render:function(e,t){var n;if(e!==!1){if(n=this.getTemplate(e),!n)throw"Template "+e+" not found!";return n(t)}},getTemplate:function(e){var t,n,r,o,s,l,p,c,a;for(c=this.lookups,n=0,o=c.length;o>n;n++)for(l=c[n],a=[e,this.withTemplate(e)],r=0,s=a.length;s>r;r++)if(p=a[r],t=u.Config.getOption("templates").getOption("engine"),i.isFunction(t)&&(t=t()),t[l+p])return t[l+p]},withTemplate:function(e){var t;return null!=e?(t=e.split("/"),t.splice(-1,0,"templates"),t.join("/")):void 0}}),u.Views=new u.Object,u.Views.templateHelpers={t:u.I18n.t},i.extend(r.View.prototype,{templateHelpers:function(){return u.Views.templateHelpers}}),u.Views.CollectionView=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t}(r.CollectionView),u.Views.CompositeView=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t}(r.CompositeView),u.Views.LayoutView=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t}(r.LayoutView),u.Views.ItemView=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t}(r.ItemView),u.Entities=new u.Object,u.Controllers=new u.Object,u.Controllers.Application=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t}(u.Object),u.Application=u.Application.extend({I18n:u.I18n,Controllers:u.Controllers,Entities:u.Entities,Views:u.Views,navigate:function(e,t){return null==t&&(t={}),n.history.navigate(e,t)},getCurrentRoute:function(){var e;return e=n.history.fragment,i.isEmpty(e)?null:e},startHistory:function(e){return null==e&&(e={}),n.history?n.history.start(e):void 0},register:function(e,t){return null==this._registry&&(this._registry={}),this._registry[t]=e},unregister:function(e,t){return delete this._registry[t]},resetRegistry:function(){var e,t,n,r,i;r=this.getRegistrySize(),i=this._registry;for(t in i)e=i[t],e.region.close();return n="There were "+r+" controllers in the registry, there are now "+this.getRegistrySize(),this.getRegistrySize()>0?console.warn(n,this._registry):console.log(n)},getRegistrySize:function(){return i.size(this._registry)}}),u});